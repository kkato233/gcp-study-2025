# Google Compute Engine（GCE）まとめ

## 概要
- 対象: Google Compute Engine（GCE）= 仮想マシン（VM）を提供する IaaS
- 主用途: 汎用サーバ、バッチ処理、レガシー移行、チューニングが要るワークロード、GPU/ローカルSSD活用

## 利点
- 柔軟性: 豊富なマシンタイプ、カスタム vCPU/メモリ、GPU/ローカル SSD、専有ホスト（Sole‑tenant）
- 可用性: Live Migration、MIG（マネージドインスタンスグループ）のオートヒーリング/オートスケール、複数ゾーン/リージョン展開
- ネットワーク: グローバル/リージョン LB、VPC/共有 VPC、内部 LB、Cloud NAT、きめ細かなファイアウォール
- ストレージ: 永続ディスク（標準/SSD/Extreme、Regional PD）、スナップショット、Cloud Storage/Filestore 連携
- 運用性: API/CLI/IaC（Terraform）整備、イメージ/テンプレート/ポリシーで再現性、メタデータ/スタートアップスクリプト

## 欠点
- 運用負荷: OS パッチ、ミドル運用、バックアップ、監視設計が必要（PaaS/サーバレスより重い）
- スケール即応性: 起動時間・ウォームアップが必要（超突発スパイクはサーバレスに劣る）
- 配置設計の複雑さ: ゾーン/リージョン、ディスク種別、LB/ネットワーク、MIG ポリシーなど設計事項が多い
- ロックイン回避の工数: 画像管理・起動スクリプト・メタデータ依存を整理しないと移行が重くなる

## 価格の利点
- 従量＋割引オプション: 秒課金（最小 1 分）、継続利用割引（SUD）、コミット利用割引（CUD）、Spot VM（大幅割引）
- 細粒度最適化: カスタムマシンで無駄な vCPU/メモリを削減、汎用ファミリでコスト効率
- アーキ節約: MIG のスケールイン、スケジュール停止、キャッシュや LB 併用でトータル費用抑制

## 価格の欠点
- 周辺費用: ネットワークエグレス、Regional PD（冗長化コスト）、スナップショット/バックアップ、監視/運用ツール費
- ライセンス: Windows/SQL Server、商用ミドルウェアの追加費用
- 割引の前提条件: CUD は予測・固定費化が必要、SUD は一定稼働が前提、Spot はいつでもプリエンプトされる設計が必要
- スケールの線形増: 水平/垂直増強で費用は比例的に増えるため最適化が鍵

## 選定の目安
- IaaS が向く場合: OS/ミドルに自由度が必要、GPU/ローカル SSD、特殊ドライバ、レガシー移行、恒常的な高負荷
- 代替検討: 超突発/イベント駆動は Cloud Run、Kubernetes 運用前提は GKE、RDB 中心は Cloud SQL/AlloyDB、グローバル強整合は Spanner

## コスト最適化 Tips（抜粋）
- 予測できるベース負荷は CUD、突発分はオンデマンドや Spot で分離
- MIG のオートスケールとヘルスチェックでムダな稼働を削減
- ディスクは必要 IOPS/スループットに応じて PD 種別を選定、不要なスナップは自動削除
- エグレスは Cloud CDN/リージョン設計/圧縮で最小化、Private Service Connect/ILB で内部化
