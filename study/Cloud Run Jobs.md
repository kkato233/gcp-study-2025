# Cloud Run Jobs まとめ

## 概要
- 対象: サーバレスのバッチ/一括処理（Knative Jobベース）
- 主用途: 定期バッチ、ETL/ELT、画像/動画処理、バックグラウンドメンテナンス、ファンアウト/並列実行

## 利点
- サーバレス実行: インフラ管理不要、実行時のみ課金、並列度を指定して分散処理
- 運用容易: リトライ/最大同時数/タイムアウト、リビジョン管理、Cloud Scheduler で定期実行
- 連携: Cloud Storage/BigQuery/Dataflow/PubSub と自然連携、VPCコネクタも利用可能

## 欠点
- 実行モデル制約: 長時間常駐ワーカー向きではない、ジョブ最大実行時間/同時実行の制約
- ステート管理: 永続状態は外部ストア依存、ローカルは短命
- ネットワーク: 高スループットの双方向通信や特殊ドライバ要件は不向き

## 価格の利点
- 完全従量: 実行時間中の vCPU/メモリ・リクエスト課金、アイドルコストほぼゼロ
- スパイク対応: 必要時のみスケールアウトし費用最小化

## 価格の欠点
- 長時間/高負荷: 常時稼働や重い処理はGKE/GCEの方が安い場合あり
- 周辺費用: VPCコネクタ、ログ/メトリクス、エグレスで加算

## 選定の目安
- 向く: イベント/スケジュール駆動のバッチ、画像変換、ETLの前処理など
- 代替: 継続稼働/複雑な分散制御→ Dataflow/GKE、特殊ドライバ→ GCE

## コスト最適化 Tips
- 並列度とメモリ/CPUを実測で最適化、起動時間短縮の軽量イメージ
- 入出力の局所性確保（同リージョンのGCS/BigQuery）でネットワーク費削減
- 冪等/再実行可能設計でリトライ回数を最小化
